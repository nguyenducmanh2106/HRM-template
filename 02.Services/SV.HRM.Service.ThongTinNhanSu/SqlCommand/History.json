{
  "History": {
    "Proc_Grid": "History_Grid_Dynamic",
    "Proc_Create": "proc_History_Create",
    "Proc_Update": "proc_History_Update",
    "CreateBeforeJoiningCompany": "proc_History_CreateBeforeJoiningCompany",
    "GetMinFromDate": " SELECT Todate from History where StaffID = @StaffID AND [Status] <> 3 Order by FromDate DESC, Todate DESC OFFSET 0 ROWS FETCH NEXT 1 ROWS ONLY;",
    "FindById": "SELECT h.DeptID,h.TrinhDoChuyenMonID,tdcm.TrinhDoChuyenMonName,h.Note,h.ExtraText1,h.ExtraLogic2,h.ExtraLogic3,h.ExtraText2,h.ExtraText3,h.ExtraText4,h.ExtraText5,h.ExtraText6,h.ExtraText7,h.ExtraText8,h.ExtraNumber1,h.ExtraNumber2,h.ExtraNumber3,h.ExtraNumber4,h.ExtraDate1,h.ExtraDate2,h.ExtraLogic1,h.StaffID,h.[Status],h.HistoryNo,h.DecisionDate,h.FromDate,h.Todate,h.JobTitleID,jt.JobTitleName,h.PositionID,p.PositionName,h.CategoryID,c.CategoryName,h.WorkGroupID,wg.WorkGroupName,cvcq.ChucVuChinhQuyenName,cvkn.ChucVuKiemNhiemName from History h LEFT JOIN JobTitle jt on h.JobTitleID = jt.JobTitleID LEFT JOIN Position p on h.PositionID = p.PositionID LEFT JOIN Category c on h.CategoryID = c.CategoryID left join TrinhDoChuyenMon tdcm on h.TrinhDoChuyenMonID = tdcm.TrinhDoChuyenMonID LEFT JOIN WorkGroup wg on h.WorkGroupID = wg.WorkGroupID left join ChucVuChinhQuyen cvcq on h.ExtraNumber3 = cvcq.ChucVuChinhQuyenID left join ChucVuKiemNhiem cvkn on h.ExtraNumber4 = cvkn.ChucVuKiemNhiemID WHERE h.HistoryID = @HistoryID",
    "UpdateBeforeJoiningCompany": "proc_History_UpdateBeforeJoiningCompany",
    "FindByBelongHistoryNow": "select * from History where HistoryID=@HistoryID and [Status] = 4 and FromDate >= @FromDate and Todate <= @Todate Order by FromDate DESC, Todate DESC OFFSET 0 ROWS FETCH NEXT 1 ROWS ONLY;",
    "FindRecordLastest": "select * from History where StaffID=@StaffID and [Status] <> 4 Order by FromDate DESC, Todate DESC OFFSET 0 ROWS FETCH NEXT 1 ROWS ONLY;",
    "FindByStaffAndDate1": "select Top 1 * from History where StaffID=@StaffID and FromDate = @FromDate and Todate = @ToDate and [Status] <> 4",
    "FindByStaffAndDate2": "select Top 1 * from History where StaffID=@StaffID and FromDate = @FromDate and Todate = @ToDate and [Status] = 4",
    "GetHistoryLatest": "select T.* from (SELECT h.DeptID,h.TrinhDoChuyenMonID,tdcm.TrinhDoChuyenMonName,h.Note,h.ExtraText1,h.ExtraLogic2,h.ExtraText2,h.ExtraText3,h.ExtraText4,h.ExtraText5,h.ExtraText6,h.ExtraText7,h.ExtraText8,h.ExtraNumber1,h.ExtraNumber2,h.ExtraNumber3,h.ExtraNumber4,h.ExtraDate1,h.ExtraDate2,h.ExtraLogic1,h.StaffID,h.[Status],h.HistoryNo,h.DecisionDate,h.FromDate,h.Todate,h.JobTitleID,jt.JobTitleName,h.PositionID,p.PositionName,h.CategoryID,c.CategoryName,h.WorkGroupID,wg.WorkGroupName,cvcq.ChucVuChinhQuyenName,cvkn.ChucVuKiemNhiemName,ROW_NUMBER() over(partition by h.StaffID order by h.FromDate desc,h.Todate desc) as row_num from History h LEFT JOIN JobTitle jt on h.JobTitleID = jt.JobTitleID LEFT JOIN Position p on h.PositionID = p.PositionID LEFT JOIN Category c on h.CategoryID = c.CategoryID left join TrinhDoChuyenMon tdcm on h.TrinhDoChuyenMonID = tdcm.TrinhDoChuyenMonID LEFT JOIN WorkGroup wg on h.WorkGroupID = wg.WorkGroupID left join ChucVuChinhQuyen cvcq on h.ExtraNumber3 = cvcq.ChucVuChinhQuyenID left join ChucVuKiemNhiem cvkn on h.ExtraNumber4 = cvkn.ChucVuKiemNhiemID WHERE h.StaffID =  @StaffID AND h.Status <> 4) as T WHERE T.row_num = 1"
  }
}
